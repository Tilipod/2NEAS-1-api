{
  "swagger": "2.0",
  "info": {
    "description": "Менеджер, управляющий задачами по обучению нейронных сетей",
    "version": "0.0.1",
    "title": "2NEAS-1-scheduler"
  },
  "host": "localhost:50003",
  "basePath": "/",
  "tags": [
    {
      "name": "client-request-controller",
      "description": "Контроллер для запросов клиента (API-сервера)"
    }
  ],
  "paths": {
    "/client/": {
      "post": {
        "tags": [
          "client-request-controller"
        ],
        "summary": "Создать новую задачу по обучению нейронной сети",
        "operationId": "createTaskUsingPOST",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "*/*"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "request",
            "description": "request",
            "required": true,
            "schema": {
              "$ref": "#/definitions/TrainingRequest"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          "201": {
            "description": "Created"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          },
          "404": {
            "description": "Not Found"
          }
        },
        "deprecated": false
      }
    },
    "/client/{taskId}": {
      "get": {
        "tags": [
          "client-request-controller"
        ],
        "summary": "Получить статус задачи по обучению нейронной сети",
        "operationId": "getTaskStatusUsingGET",
        "produces": [
          "*/*"
        ],
        "parameters": [
          {
            "name": "taskId",
            "in": "path",
            "description": "taskId",
            "required": true,
            "type": "string",
            "format": "uuid"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "type": "string",
              "enum": [
                "CREATED",
                "ANALYSIS",
                "ANALYZED",
                "DISTRIBUTING",
                "DISTRIBUTED",
                "TRAINING",
                "TRAINED",
                "CONFIRMED",
                "STOPPED",
                "ANALYSIS_ERROR",
                "TRAINING_ERROR",
                "DISTRIBUTE_ERROR",
                "SYSTEM_ERROR"
              ]
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          },
          "404": {
            "description": "Not Found"
          }
        },
        "deprecated": false
      }
    },
    "/client/{taskId}/redistribute": {
      "post": {
        "tags": [
          "client-request-controller"
        ],
        "summary": "Откатить задачу и повторно выгрузить датасеты",
        "operationId": "redistributeUsingPOST",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "*/*"
        ],
        "parameters": [
          {
            "name": "taskId",
            "in": "path",
            "description": "taskId",
            "required": true,
            "type": "string",
            "format": "uuid"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "type": "boolean"
            }
          },
          "201": {
            "description": "Created"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          },
          "404": {
            "description": "Not Found"
          }
        },
        "deprecated": false
      }
    },
    "/client/{taskId}/result": {
      "get": {
        "tags": [
          "client-request-controller"
        ],
        "summary": "Получить результат задачи по обучению нейронной сети",
        "operationId": "getTaskTrainingResultUsingGET",
        "produces": [
          "*/*"
        ],
        "parameters": [
          {
            "name": "taskId",
            "in": "path",
            "description": "taskId",
            "required": true,
            "type": "string",
            "format": "uuid"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/TrainingResponse"
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          },
          "404": {
            "description": "Not Found"
          }
        },
        "deprecated": false
      }
    },
    "/client/{taskId}/stop": {
      "post": {
        "tags": [
          "client-request-controller"
        ],
        "summary": "Остановить задачу по обучению нейронной сети",
        "operationId": "stopTrainingUsingPOST",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "*/*"
        ],
        "parameters": [
          {
            "name": "taskId",
            "in": "path",
            "description": "taskId",
            "required": true,
            "type": "string",
            "format": "uuid"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "type": "boolean"
            }
          },
          "201": {
            "description": "Created"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          },
          "404": {
            "description": "Not Found"
          }
        },
        "deprecated": false
      }
    }
  },
  "definitions": {
    "InputTypeDto": {
      "type": "object",
      "required": [
        "inputType"
      ],
      "properties": {
        "channels": {
          "type": "integer",
          "format": "int32",
          "description": "Кол-во каналов (для СНС)"
        },
        "height": {
          "type": "integer",
          "format": "int32",
          "description": "Высота изображения (для СНС)"
        },
        "inputType": {
          "type": "string",
          "description": "Тип входных данных",
          "enum": [
            "CONVOLUTIONAL"
          ]
        },
        "weight": {
          "type": "integer",
          "format": "int32",
          "description": "Ширина изображения (для СНС)"
        }
      },
      "title": "InputTypeDto"
    },
    "LayerDto": {
      "type": "object",
      "required": [
        "countOutput",
        "layerNumber",
        "layerType"
      ],
      "properties": {
        "activationType": {
          "type": "string",
          "description": "Функция активации для нейронов слоя",
          "enum": [
            "CUBE",
            "ELU",
            "HARDSIGMOID",
            "HARDTANH",
            "IDENTITY",
            "LEAKYRELU",
            "RATIONALTANH",
            "RELU",
            "RRELU",
            "SIGMOID",
            "SOFTMAX",
            "SOFTPLUS",
            "SOFTSIGN",
            "TANH",
            "RECTIFIEDTANH",
            "SELU"
          ]
        },
        "countInput": {
          "type": "integer",
          "format": "int32",
          "description": "Кол-во входов"
        },
        "countOutput": {
          "type": "integer",
          "format": "int32",
          "description": "Кол-во выходов"
        },
        "layerNumber": {
          "type": "integer",
          "format": "int32",
          "description": "Номер слоя"
        },
        "layerType": {
          "type": "string",
          "description": "Тип слоя",
          "enum": [
            "CONVOLUTIONAL",
            "BATCH_NORMALIZATION",
            "DENSE",
            "OUTPUT"
          ]
        },
        "strideHeight": {
          "type": "integer",
          "format": "int32",
          "description": "Высота фильтра (только для сверточного слоя)"
        },
        "strideWeight": {
          "type": "integer",
          "format": "int32",
          "description": "Ширина фильтра (только для сверточного слоя)"
        },
        "weightInitType": {
          "type": "string",
          "description": "Способ инициализации весов нейронов слоя",
          "enum": [
            "DISTRIBUTION",
            "ZERO",
            "SIGMOID_UNIFORM",
            "UNIFORM",
            "XAVIER",
            "XAVIER_UNIFORM",
            "XAVIER_FAN_IN",
            "XAVIER_LEGACY",
            "RELU",
            "RELU_UNIFORM"
          ]
        }
      },
      "title": "LayerDto"
    },
    "NeuronNetworkDto": {
      "type": "object",
      "required": [
        "pathToSave",
        "taskId"
      ],
      "properties": {
        "backprop": {
          "type": "boolean",
          "description": "Использовать обратное распространение ошибки"
        },
        "inputType": {
          "$ref": "#/definitions/InputTypeDto"
        },
        "iterations": {
          "type": "integer",
          "format": "int32",
          "description": "Кол-во итераций на каждой эпохе обучения"
        },
        "layers": {
          "type": "array",
          "description": "Настройки слоев сети",
          "items": {
            "$ref": "#/definitions/LayerDto"
          }
        },
        "learningRate": {
          "type": "number",
          "format": "double",
          "description": "Скорость обучения"
        },
        "optimizationAlgo": {
          "type": "string",
          "description": "Алгоритм обучения",
          "enum": [
            "LINE_GRADIENT_DESCENT",
            "CONJUGATE_GRADIENT",
            "HESSIAN_FREE",
            "LBFGS",
            "STOCHASTIC_GRADIENT_DESCENT"
          ]
        },
        "pathToSave": {
          "type": "string",
          "description": "Путь к файлу сохранения модели сети"
        },
        "pretrain": {
          "type": "boolean",
          "description": "Признак предварительного обучения"
        },
        "regularization": {
          "$ref": "#/definitions/RegularizationDto"
        },
        "seed": {
          "type": "integer",
          "format": "int32",
          "description": "Число-инициализатор для генератора случайных чисел"
        },
        "taskId": {
          "type": "integer",
          "format": "int32",
          "description": "ID задачи"
        },
        "updater": {
          "$ref": "#/definitions/UpdaterDto"
        },
        "weightInit": {
          "type": "string",
          "description": "Правило инициализации весов",
          "enum": [
            "DISTRIBUTION",
            "ZERO",
            "SIGMOID_UNIFORM",
            "UNIFORM",
            "XAVIER",
            "XAVIER_UNIFORM",
            "XAVIER_FAN_IN",
            "XAVIER_LEGACY",
            "RELU",
            "RELU_UNIFORM"
          ]
        }
      },
      "title": "NeuronNetworkDto"
    },
    "RegularizationDto": {
      "type": "object",
      "properties": {
        "needRegularization": {
          "type": "boolean",
          "description": "Требуется ли проводить регуляризацию"
        },
        "regularizationBias": {
          "type": "number",
          "format": "double",
          "description": "Смещение при регуляризации"
        },
        "regularizationFactor": {
          "type": "number",
          "format": "double",
          "description": "Коэффициент регуляризации"
        },
        "regularizationType": {
          "type": "string",
          "description": "Тип регуляризации",
          "enum": [
            "L1",
            "L2"
          ]
        }
      },
      "title": "RegularizationDto"
    },
    "TrainingRequest": {
      "type": "object",
      "properties": {
        "cloudToken": {
          "type": "string",
          "description": "Токен для авторизации в облаке"
        },
        "cloudType": {
          "type": "string",
          "description": "Тип облака для выгрузки датасетов",
          "enum": [
            "YANDEX"
          ]
        },
        "countEpoch": {
          "type": "integer",
          "format": "int32",
          "description": "Кол-во эпох для обучения нейросети"
        },
        "datasetType": {
          "type": "string",
          "description": "Тип данных для обучения нейросети",
          "enum": [
            "IMAGE"
          ]
        },
        "neuronNetworkStructure": {
          "description": "Структура нейросети",
          "$ref": "#/definitions/NeuronNetworkDto"
        },
        "pathToDataset": {
          "type": "string",
          "description": "Путь к папке в облаке с датасетами"
        },
        "withMentoring": {
          "type": "boolean",
          "description": "Включить подкрепление к обучению"
        }
      },
      "title": "TrainingRequest",
      "description": "Запрос на создание задачи по обучению нейронной сети"
    },
    "TrainingResponse": {
      "type": "object",
      "properties": {
        "comment": {
          "type": "string",
          "description": "Комментарий к статусу"
        },
        "model": {
          "type": "string",
          "format": "byte",
          "description": "Модель обученной нейросети"
        },
        "status": {
          "type": "string",
          "description": "Текущий статус задачи на обучение",
          "enum": [
            "CREATED",
            "ANALYSIS",
            "ANALYZED",
            "DISTRIBUTING",
            "DISTRIBUTED",
            "TRAINING",
            "TRAINED",
            "CONFIRMED",
            "STOPPED",
            "ANALYSIS_ERROR",
            "TRAINING_ERROR",
            "DISTRIBUTE_ERROR",
            "SYSTEM_ERROR"
          ]
        }
      },
      "title": "TrainingResponse",
      "description": "Обученная нейронная сеть"
    },
    "UpdaterDto": {
      "type": "object",
      "properties": {
        "updaterFactor": {
          "type": "number",
          "format": "double",
          "description": "Коэффициент оптимизации скорости обучения"
        },
        "updaterType": {
          "type": "string",
          "description": "Тип оптимизации скорости обучения",
          "enum": [
            "NESTEROVS"
          ]
        }
      },
      "title": "UpdaterDto"
    }
  }
}